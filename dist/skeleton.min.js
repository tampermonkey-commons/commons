class Skeleton{constructor(e){this.name=(e.hasOwnProperty("name")?e:GM_info.script).name,this.version=(e.hasOwnProperty("version")?e:GM_info.script).version,this.optionsUrl=e.hasOwnProperty("url")?e.url:null,this.logger=new Logger(this.name),this.injector=new DynamicInjector,this.appNodeId=null,this.injectStyles=null,this.vueVersion=e.hasOwnProperty("vue")?e.vue:null,this.vue=null,this.vueOptions=null,this.vueApp=null,this.elementVersion=e.hasOwnProperty("element")?e.element:null,this.element=null,this.vuexVersion=e.hasOwnProperty("vuex")?e.vuex:null,this.vuex=null,this.storeOptions=null}async dynamicInjectVue(){let e=!1,t=this;if(null!=this.vueVersion&&!(e=await this.injector.dynamicInject("vue",this.vueVersion,"/dist/vue.global.prod.js",5e3,()=>{if("undefined"!=typeof Vue)return t.vue=Vue,t.logger.info("Vue %s Loaded.",t.vue.version),!0})))return e;if(null!=this.elementVersion){if(!(e=await this.injector.dynamicInject("element-plus",this.elementVersion,"/dist/index.full.min.js",5e3,()=>{if("undefined"!=typeof ElementPlus)return t.element=ElementPlus,t.logger.info("Element Plus %s Loaded.",t.element.version),!0})))return e;this.injector.dynamicInject("element-plus",this.elementVersion,"/dist/index.min.css")}return!(null!=this.vuexVersion&&!(e=await this.injector.dynamicInject("vuex",this.vuexVersion,"/dist/vuex.global.min.js",5e3,()=>{if("undefined"!=typeof Vuex)return t.vuex=Vuex,t.logger.info("Vuex %s Loaded.",t.vuex.version),!0})))||e}async dynamicInjectOptions(e,n=void 0){if(null==n){let t=this;n=()=>{let e=0;return"undefined"!=typeof appNodeId&&(t.appNodeId=appNodeId,e++),"undefined"!=typeof vueAppOptions&&(t.vueOptions=vueAppOptions,e++),"undefined"!=typeof storeOptions&&(t.storeOptions=storeOptions,e++),"undefined"!=typeof injectStyles&&(t.injectStyles=injectStyles,e++),0<e}}return await this.injector.dynamicInjectByUrl(e,5e3,n)}async createVueApp(e){var t;return!!await this.dynamicInjectVue()&&!!await this.dynamicInjectOptions(e)&&(null==(e=document.getElementById(this.appNodeId))&&((e=document.createElement("div")).id=this.appNodeId,document.body.appendChild(e)),e=this.vue.createApp(this.vueOptions),null!=this.element&&e.use(this.element),null!=this.storeOptions&&(t=this.vuex.createStore(this.storeOptions),e.use(t)),e.mount("#"+this.appNodeId),this.vueApp=e,!0)}async start(){this.createVueApp(this.optionsUrl)}}