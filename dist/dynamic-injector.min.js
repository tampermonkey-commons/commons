class DynamicInjector{constructor(){this.version="0.5.0",this.defaultCDN="https://cdn.jsdelivr.net/npm/",this.logger=new Logger("dynamic-injector")}sleep=t=>new Promise(e=>setTimeout(e,t));getFileExtName(e){var e=new URL(e).pathname,t=e.lastIndexOf(".");return e.substring(t)}async dynamicInjectByUrl(e,t=5e3,n=void 0){var i=this.getFileExtName(e);if(".js"!=i)return".css"==i?((i=document.createElement("link")).href=e,i.rel="stylesheet",document.head.appendChild(i),!0):(this.logger.warn("未识别的资源类型：%s",e),!1);(i=document.createElement("script")).src=e,document.body.appendChild(i);let r=!1;var s,a=new Date;do{if(t<=(new Date).getTime()-a.getTime())return this.logger.warn("动态加载 %s 超时",e),!1;if(await this.sleep(10),null!=n){if(r=n())return s=(new Date).getTime()-a.getTime(),this.logger.debug("动态加载 %s 成功，耗时：%d ms",e,s),!0}else r=!0}while(!r);return r}async dynamicInjectFromCDN(e,t,n,i,r=5e3,s=void 0){let a=t;null!=n&&0<n.length&&(a+="@"+n);t=""+e+a+i;return this.dynamicInjectByUrl(t,r,s)}async dynamicInject(e,t,n,i=5e3,r=void 0){return this.dynamicInjectFromCDN(this.defaultCDN,e,t,n,i,r)}}